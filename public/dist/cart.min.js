var __awaiter=this&&this.__awaiter||function(t,c,a,u){return new(a=a||Promise)(function(e,r){function o(t){try{i(u.next(t))}catch(t){r(t)}}function n(t){try{i(u.throw(t))}catch(t){r(t)}}function i(t){var r;t.done?e(t.value):((r=t.value)instanceof a?r:new a(function(t){t(r)})).then(o,n)}i((u=u.apply(t,c||[])).next())})},__generator=this&&this.__generator||function(e,o){var n,i,c,a={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]},t={next:r(0),throw:r(1),return:r(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function r(r){return function(t){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(c=2&r[0]?i.return:r[0]?i.throw||((c=i.return)&&c.call(i),0):i.next)&&!(c=c.call(i,r[1])).done)return c;switch(i=0,c&&(r=[2&r[0],c.value]),r[0]){case 0:case 1:c=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(c=0<(c=a.trys).length&&c[c.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!c||r[1]>c[0]&&r[1]<c[3])){a.label=r[1];break}if(6===r[0]&&a.label<c[1]){a.label=c[1],c=r;break}if(c&&a.label<c[2]){a.label=c[2],a.ops.push(r);break}c[2]&&a.ops.pop(),a.trys.pop();continue}r=o.call(e,a)}catch(t){r=[6,t],i=0}finally{n=c=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,t])}}};function getStoresProducts(){return __awaiter(this,void 0,void 0,function(){var r,e,o,n,i,c;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,axios.get("/store/mall")];case 1:return r=t.sent(),e=r.data,o=e.stores,n=e.shippingAddress,i=[],o.stores.forEach(function(t){i=i.concat(t.products)}),renderCartProducts(i,cartProductsToRender,n),[3,3];case 2:return c=t.sent(),console.error(c.message),[3,3];case 3:return[2]}})})}function renderCartProducts(n,t,r){try{var e=document.querySelector(".products"),o=document.querySelector("#pay"),i=void 0,c=0<t.length,a=0,u=0;c?(i='\n            <div class="products__item products__item--headers">\n                <h4>Remove</h4>\n                <h4>Product Image</h4>\n                <h4>Product Name</h4>\n                <h4>Left in Stock</h4>\n                <h4>Total Price</h4>\n                <h4>Quantity</h4>\n            </div>'+t.map(function(r){var t=n.findIndex(function(t){return t.productUuid===r.productUuid}),e=n[t].inStock+" left",o=5<n[t].inStock?"green":"orange";return a+=r.totalPrice,u+=r.quantity,'\n                <div class="products__item product-row" id="'+r.productUuid+'">\n                    <div class="product-row__item product-row__item--remove">\n                        <i class="fas fa-trash remove-from-cart" title="Remove '+r.productName+' from cart"></i>\n                    </div>\n                    <a href="./product.html?storeUuid='+n[t].storeUuid+"&productUuid="+n[t].productUuid+'" class="product-row__item product-row__item--img">\n                        <img src="'+n[t].productImage+'" title="'+r.productName+'"/>\n                    </a>\n                    <a href="./product.html?storeUuid='+n[t].storeUuid+"&productUuid="+n[t].productUuid+'" class="product-row__item product-row__item--name">\n                        <h3>'+r.productName+'</h3>\n                    </a>\n                    <div class="product-row__item product-row__item--stock" style="color:'+o+'">'+e+'</div>\n                    <h4 class="product-row__item product-row__item--total">'+(Math.round(100*r.totalPrice)/100).toFixed(2)+'$</h4>\n                    <div class="product-row__item product-row__item--quantity">\n                        <input type="number" class="update-cart-qunatity" min="0" max="'+(r.quantity+n[t].inStock)+'" value="'+r.quantity+'" />\n                    </div>\n                </div>'}).join("")+('\n            <div class="products__item products__item--footers">\n                <h3>Total:</h3>\n                <h3></h3>\n                <h3></h3>\n                <h3></h3>\n                <h3>'+(Math.round(100*a)/100).toFixed(2)+"$</h3>\n                <h3>"+u+"</h3>\n            </div>")+('\n            <div class="products__item products__item--footers">\n                <h3>Shipping Address:</h3>\n                <h4>'+r+"</h4>\n            </div>"),o.classList.remove("hide"),o.disabled=0===u):(i='<p>Your cart is empty... <a href="./store.html?storeUuid=mall">Click here</a> to do some shopping!</p>',o.classList.add("hide")),e.innerHTML=i}catch(t){console.error(t.message)}}getStoresProducts();