var __awaiter=this&&this.__awaiter||function(t,c,i,s){return new(i=i||Promise)(function(e,r){function o(t){try{a(s.next(t))}catch(t){r(t)}}function n(t){try{a(s.throw(t))}catch(t){r(t)}}function a(t){var r;t.done?e(t.value):((r=t.value)instanceof i?r:new i(function(t){t(r)})).then(o,n)}a((s=s.apply(t,c||[])).next())})},__generator=this&&this.__generator||function(e,o){var n,a,c,i={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]},t={next:r(0),throw:r(1),return:r(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function r(r){return function(t){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(c=2&r[0]?a.return:r[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,r[1])).done)return c;switch(a=0,c&&(r=[2&r[0],c.value]),r[0]){case 0:case 1:c=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(c=0<(c=i.trys).length&&c[c.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!c||r[1]>c[0]&&r[1]<c[3])){i.label=r[1];break}if(6===r[0]&&i.label<c[1]){i.label=c[1],c=r;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(r);break}c[2]&&i.ops.pop(),i.trys.pop();continue}r=o.call(e,i)}catch(t){r=[6,t],a=0}finally{n=c=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,t])}}};function getStoresProducts(){return __awaiter(this,void 0,void 0,function(){var r,e,o,n,a,c;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,axios.get("/store/mall")];case 1:return r=t.sent(),e=r.data,o=e.stores,n=e.shippingAddress,a=[],o.stores.forEach(function(t){a=a.concat(t.products)}),renderCartPageProducts(a,cartProductsToRender,savedProducts,n),[3,3];case 2:return c=t.sent(),console.error(c.message),[3,3];case 3:return[2]}})})}function renderCartPageProducts(t,r,e,o){try{var n=void 0,a=document.querySelector(".carts"),c=document.querySelector("#pay"),i=0<r.length,h=0,p=0;i?(n=u(r,t,!0)+('\n            <div class="carts__item carts__item--footers">\n                <h3>Total:</h3>\n                <h3></h3>\n                <h3></h3>\n                <h3></h3>\n                <h3>'+(Math.round(100*h)/100).toFixed(2)+"$</h3>\n                <h3>"+p+"</h3>\n            </div>")+('\n            <div class="carts__item carts__item--footers">\n                <h3>Shipping Address:</h3>\n                <h4>'+o+"</h4>\n            </div>"),c.classList.remove("hide"),c.disabled=0===p):(n='<p>Your cart is empty... <a href="./store.html?storeUuid=mall">Click here</a> to do some shopping!</p>',c.classList.add("hide")),a.innerHTML=n;var s=document.querySelector(".saved");function u(t,u,d){try{var l=d?"carts":"saved";return'\n                <div class="'+l+"__item "+l+'__item--headers">\n                    <h4>Actions</h4>\n                    <h4>Product Image</h4>\n                    <h4>Product Name</h4>\n                    <h4>Stock Status</h4>\n                    <h4>'+(d?"Total":"Product")+" Price</h4>\n                    <h4>Quantity</h4>\n                </div>"+t.map(function(t){var r,e=d?t.productUuid:t,o=u.findIndex(function(t){return t.productUuid===e}),n=0<u[o].inStock?(r=5<u[o].inStock?"In Stock":"Running Out!",5<u[o].inStock?"green":"orange"):(r="Out of Stock","red");h+=t.totalPrice,p+=t.quantity;var a=d?'<i class="fas fa-trash remove-from-cart" title="Remove '+u[o].productName+' from cart"></i>\n                    <i class="fas fa-save save-for-later" title="Save '+u[o].productName+' for later"></i>':'<i class="fas fa-trash remove-from-saved" title="Unsave '+u[o].productName+'"></i>\n                    <i class="fas fa-cart-plus add-to-cart" title="Add '+u[o].productName+' to cart"></i>',c=d?"1":"0",i=d?(Math.round(100*t.totalPrice)/100).toFixed(2):(Math.round(100*(u[o].productPrice-u[o].productPrice*(u[o].precentsOff/100)))/100).toFixed(2),s=d?'<input type="number" class="update-cart-qunatity" min="'+c+'" max="'+u[o].inStock+'" value="'+t.quantity+'" />':"0";return'\n                    <div class="'+l+'__item product-row" id="'+u[o].productUuid+'">\n                        <div class="product-row__item product-row__item--actions">\n                            '+a+'\n                        </div>\n                        <a href="./product.html?storeUuid='+u[o].storeUuid+"&productUuid="+u[o].productUuid+'" class="product-row__item product-row__item--img">\n                            <img src="'+u[o].productImage+'" title="'+u[o].productName+'"/>\n                        </a>\n                        <a href="./product.html?storeUuid='+u[o].storeUuid+"&productUuid="+u[o].productUuid+'" class="product-row__item product-row__item--name">\n                            <h3>'+u[o].productName+'</h3>\n                        </a>\n                        <div class="product-row__item product-row__item--stock" style="color:'+n+'">'+r+'</div>\n                        <h4 class="product-row__item product-row__item--price">'+i+'$</h4>\n                        <div class="product-row__item product-row__item--quantity">\n                            '+s+"\n                        </div>\n                    </div>"}).join("")}catch(t){console.error(t.message)}}n=0<e.length?u(e,t,!1):"You have no saved products",s.innerHTML=n}catch(t){console.error(t.message)}}getStoresProducts();