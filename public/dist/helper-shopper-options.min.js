var payBtn,__awaiter=this&&this.__awaiter||function(t,u,s,c){return new(s=s||Promise)(function(r,e){function a(t){try{o(c.next(t))}catch(t){e(t)}}function n(t){try{o(c.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?r(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(a,n)}o((c=c.apply(t,u||[])).next())})},__generator=this&&this.__generator||function(r,a){var n,o,u,s={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(u=2&e[0]?o.return:e[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,e[1])).done)return u;switch(o=0,u&&(e=[2&e[0],u.value]),e[0]){case 0:case 1:u=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,o=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(u=0<(u=s.trys).length&&u[u.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!u||e[1]>u[0]&&e[1]<u[3])){s.label=e[1];break}if(6===e[0]&&s.label<u[1]){s.label=u[1],u=e;break}if(u&&s.label<u[2]){s.label=u[2],s.ops.push(e);break}u[2]&&s.ops.pop(),s.trys.pop();continue}e=a.call(r,s)}catch(t){e=[6,t],o=0}finally{n=u=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},updateAncestor="/store.html"===whichHtmlFile?document.querySelector(".products"):document.querySelector(".main");function updateQuantity(m){return __awaiter(this,void 0,void 0,function(){var e,r,a,n,o,u,s,c,i,d,l,p,h;return __generator(this,function(t){switch(t.label){case 0:return(t.trys.push([0,7,,8]),!m.target.classList.contains("add-to-cart")&&!m.target.classList.contains("remove-from-cart")&&!m.target.classList.contains("save-for-later")&&!m.target.classList.contains("update-cart-qunatity")||"click"===m.type&&m.target.classList.contains("update-cart-qunatity"))?[2]:(e=void 0,m.target.classList.contains("add-to-cart")?(e=1,[3,4]):[3,1]);case 1:return m.target.classList.contains("remove-from-cart")?[4,swal({title:"Remove from Cart",text:"Are you sure?",icon:"warning",dangerMode:!0,buttons:{later:"Save for Later",cancel:"Nope",confirm:"Yup"}})]:[3,3];case 2:return(r=t.sent())?(e="later"===r?-2:-1,[3,4]):[2];case 3:e=m.target.classList.contains("save-for-later")&&!m.target.classList.contains("product-buttons__item")?-2:m.target.valueAsNumber,t.label=4;case 4:return a=m.target.parentElement.parentElement,productUuid=url.searchParams.get("productUuid"),productUuid=null!==productUuid&&void 0!==productUuid?productUuid:a.getAttribute("id"),n=a.querySelector(".product__item--img"),"/product.html"===whichHtmlFile?n=a.querySelector(".product-large__item--img"):"/cart.html"===whichHtmlFile&&(n=a.querySelector(".product-row__item--img")),storeUuid=url.searchParams.get("storeUuid"),o="mall"===storeUuid||"/cart.html"===whichHtmlFile,storeUuid=storeUuid&&"mall"!==storeUuid?storeUuid:n.getAttribute("href").replace(/^(.)*storeUuid=/g,"").replace(/[&](.)*$/g,""),[4,axios.put("/user/cart",{allStoresInfo:o,storeUuid:storeUuid,productUuid:productUuid,productQuantity:e})];case 5:return u=t.sent(),s=u.data,c=s.cartProducts,i=s.storeProducts,d=s.savedProducts,l=s.lovedProducts,p=s.shippingAddress,[4,renderShopperCart(c)];case 6:return t.sent(),m.target.classList.contains("add-to-cart")&&"/store.html"===whichHtmlFile?renderStoreProducts(i,c,l,!1):"/product.html"===whichHtmlFile?getProduct():"/cart.html"===whichHtmlFile&&renderCartPageProducts(i,c,d,p),[3,8];case 7:return h=t.sent(),console.error(h.message),[3,8];case 8:return[2]}})})}function updateSaved(i){return __awaiter(this,void 0,void 0,function(){var e,r,a,n,o,u,s,c;return __generator(this,function(t){switch(t.label){case 0:return(t.trys.push([0,2,,3]),i.target.classList.contains("remove-from-saved"))?(e=i.target.parentElement.parentElement,productUuid=e.getAttribute("id"),[4,axios.put("/user/saved",{productUuid:productUuid})]):[2];case 1:return r=t.sent(),a=r.data,n=a.cartProducts,o=a.storeProducts,u=a.savedProducts,s=a.shippingAddress,renderCartPageProducts(o,n,u,s),[3,3];case 2:return c=t.sent(),console.error(c.message),[3,3];case 3:return[2]}})})}function updateLoved(d){return __awaiter(this,void 0,void 0,function(){var e,r,a,n,o,u,s,c,i;return __generator(this,function(t){switch(t.label){case 0:return(t.trys.push([0,3,,4]),d.target.classList.contains("love-product")||d.target.classList.contains("product-loved"))?(e=d.target.parentElement.parentElement,productUuid=url.searchParams.get("productUuid"),productUuid=null!==productUuid&&void 0!==productUuid?productUuid:e.getAttribute("id"),r="/store.html"===whichHtmlFile?e.querySelector(".product__item--img"):e.querySelector(".product-large__item--img"),storeUuid=url.searchParams.get("storeUuid"),a="mall"===storeUuid,storeUuid="mall"===storeUuid?r.getAttribute("href").replace(/^(.)*storeUuid=/g,"").replace(/[&](.)*$/g,""):storeUuid,[4,axios.put("/user/loved",{allStoresInfo:a,storeUuid:storeUuid,productUuid:productUuid})]):[2];case 1:return n=t.sent(),o=n.data,u=o.cartProducts,s=o.storeProducts,c=o.lovedProducts,[4,renderShopperCart(u)];case 2:return t.sent(),"/store.html"===whichHtmlFile?renderStoreProducts(s,u,c,!1):"/product.html"===whichHtmlFile&&getProduct(c),[3,4];case 3:return i=t.sent(),console.error(i.message),[3,4];case 4:return[2]}})})}function purchaseCart(t){return __awaiter(this,void 0,void 0,function(){var e,a=this;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,swal({title:"Paying for Cart",text:"Do you wish to proceed?",icon:"warning",buttons:["Nope","Yup"]}).then(function(r){return __awaiter(a,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return r?[4,axios.put("/user/cart/purchase",{storeUuid:"all cart products stores",productUuid:"all cart products"})]:[3,3];case 1:return e=t.sent(),!0!==e.data.purchaseCart?[3,3]:[4,swal({title:"Congrats!",text:"You've completed the purchase",icon:"success",button:"Cool"}).then(function(){window.location.href="./store.html?storeUuid=mall"})];case 2:t.sent(),t.label=3;case 3:return[2]}})})})];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),console.error(e.message),[3,3];case 3:return[2]}})})}updateAncestor.addEventListener("click",function(t){return updateQuantity(t)}),updateAncestor.addEventListener("change",function(t){return updateQuantity(t)}),updateAncestor.addEventListener("click",function(t){return updateSaved(t)}),updateAncestor.addEventListener("click",function(t){return updateLoved(t)}),"/cart.html"===whichHtmlFile&&(payBtn=document.querySelector("#pay")).addEventListener("click",function(t){return purchaseCart(t)});