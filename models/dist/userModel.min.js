"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var r=0,s=0,e=arguments.length;s<e;s++)r+=arguments[s].length;for(var t=Array(r),n=0,s=0;s<e;s++)for(var u=arguments[s],o=0,i=u.length;o<i;o++,n++)t[n]=u[o];return t};exports.__esModule=!0,exports.Users=exports.User=void 0;var uuidv4=require("uuid").v4,fs=require("fs"),path=require("path"),usersJsonPath=path.resolve(__dirname,"../users.json"),readJsonUsers=function(){try{var r=fs.readFileSync(usersJsonPath);return JSON.parse(r)}catch(r){console.error(r)}},User=function(r,s,e,t,n){this.username=r,this.email=null===s?uuidv4():s,this.password=null===e?null:e,this.storeName=null===t?null:t,this.storeUuid=null===t?null:uuidv4(),this.products=[],this.cart=[],this.purchased=n};exports.User=User;var Users=function(){function r(){this.users=readJsonUsers()}return r.prototype.updateUsersJson=function(){try{fs.writeFileSync(usersJsonPath,JSON.stringify(this.users))}catch(r){console.error(r)}},r.prototype.createUser=function(s){try{var r=this.users.findIndex(function(r){return r.email===s.email});if(s.purchased===[])if(-1!==r){if(null!==this.users[r].password)return!0;this.users[r].password=s.password}else this.users.push(s);else-1!==r?(this.users[r].purchased=__spreadArrays(s.purchased),this.users[r].cart=[]):this.users.push(s);return this.updateUsersJson(),!1}catch(r){console.error(r)}},r.prototype.loginUser=function(s,e){try{var r=this.users.find(function(r){return r.email===s&&r.password===e});return r?r:void 0}catch(r){console.error(r)}},r.prototype.findUsername=function(s){try{var r=this.users.find(function(r){return r.email===s});return r?r.username:void 0}catch(r){console.error(r)}},r.prototype.addProductToCart=function(s,r){try{var e=this.users.findIndex(function(r){return r.email===s});this.users[e].cart.push(r),this.updateUsersJson()}catch(r){console.error(r)}},r.prototype.deleteProductFromCart=function(s,e){try{var r=this.users.findIndex(function(r){return r.email===s});this.users[r].cart=this.users[r].cart.filter(function(r){return r!==e}),this.updateUsersJson()}catch(r){console.error(r)}},r}();exports.Users=Users;