"use strict";exports.__esModule=!0,exports.onlyAdmin=exports.onlyShopper=exports.isAdmin=exports.doesUserExist=exports.isLoggedInAndVerified=void 0;var secret=require("../../secret/dist/secret").secret,jwt=require("jsonwebtoken"),Users=require("../../models/dist/usersModel").Users;function isLoggedInAndVerified(r,o,t){try{var e=r.cookies.currentUser;e?jwt.verify(e,secret,function(e,s){e?o.status(401).send({message:"You are not authorized to see this page."}):(r.currentUser=s,t())}):o.status(401).send({message:"The session has expired. Please log in again."})}catch(e){console.error(e.message),o.status(500).send(e.message)}}function doesUserExist(e,s,r){try{var o=e.currentUser.userUuid,t=(new Users).findUserIndex(o,null);if(void 0===t)throw new Error("The user was not found.");e.userUuid=o,e.userIndex=t,r()}catch(e){console.error(e.message),s.status(500).send(e.message)}}function isAdmin(e,s,r){try{var o=new Users,t=e.userIndex;e.isAdmin=0<o.users[t].stores.length,r()}catch(e){console.error(e.message),s.status(500).send(e.message)}}function onlyShopper(e,s,r){try{e.isAdmin?s.status(403).send({message:"This functionality is for shoppers only."}):r()}catch(e){console.error(e.message),s.status(500).send(e.message)}}function onlyAdmin(e,s,r){try{e.isAdmin?r():s.status(403).send({message:"You are not authorized to see this page."})}catch(e){console.error(e.message),s.status(500).send(e.message)}}exports.isLoggedInAndVerified=isLoggedInAndVerified,exports.doesUserExist=doesUserExist,exports.isAdmin=isAdmin,exports.onlyShopper=onlyShopper,exports.onlyAdmin=onlyAdmin;