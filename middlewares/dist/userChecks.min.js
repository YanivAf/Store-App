"use strict";exports.__esModule=!0,exports.onlyAdmin=exports.isAdmin=exports.doesUserExist=exports.isLoggedIn=void 0;var Users=require("../../models/dist/usersModel").Users;function isLoggedIn(s,e,r){try{var o=s.cookies.currentUser;o?(s.currentUser=o,r()):e.status(401).send({message:"The session has expired. Please log in again."})}catch(s){console.error(s.message),e.status(500).send(s.message)}}function doesUserExist(s,e,r){try{var o=s.currentUser.userUuid,n=(new Users).findUserIndex(o,null);if(void 0===n)throw new Error("The user was not found.");s.userIndex=n,r()}catch(s){console.error(s.message),e.status(500).send(s.message)}}function isAdmin(s,e,r){try{var o=new Users,n=s.userIndex;s.isAdmin=null!==o.users[n].storeUuid,r()}catch(s){console.error(s.message),e.status(500).send(s.message)}}function onlyAdmin(s,e,r){try{s.isAdmin?r():e.status(401).send({message:"You are not authorized to see this page."})}catch(s){console.error(s.message),e.status(500).send(s.message)}}exports.isLoggedIn=isLoggedIn,exports.doesUserExist=doesUserExist,exports.isAdmin=isAdmin,exports.onlyAdmin=onlyAdmin;