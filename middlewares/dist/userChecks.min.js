"use strict";exports.__esModule=!0,exports.onlyAdmin=exports.isAdmin=exports.doesUserExist=exports.isLoggedIn=void 0;var secret=require("../../secret/dist/secret").secret,jwt=require("jwt-simple"),Users=require("../../models/dist/usersModel").Users;function isLoggedIn(e,s,r){try{var t,o,n=e.cookies.currentUser;n?(t=jwt.decode(n,secret),o=JSON.parse(t),e.currentUser=o,r()):s.status(401).send({message:"The session has expired. Please log in again."})}catch(e){console.error(e.message),s.status(500).send(e.message)}}function doesUserExist(e,s,r){try{var t=e.currentUser.userUuid,o=(new Users).findUserIndex(t,null);if(void 0===o)throw new Error("The user was not found.");e.userIndex=o,r()}catch(e){console.error(e.message),s.status(500).send(e.message)}}function isAdmin(e,s,r){try{var t=new Users,o=e.userIndex;e.isAdmin=null!==t.users[o].storeUuid,r()}catch(e){console.error(e.message),s.status(500).send(e.message)}}function onlyAdmin(e,s,r){try{e.isAdmin?r():s.status(401).send({message:"You are not authorized to see this page."})}catch(e){console.error(e.message),s.status(500).send(e.message)}}exports.isLoggedIn=isLoggedIn,exports.doesUserExist=doesUserExist,exports.isAdmin=isAdmin,exports.onlyAdmin=onlyAdmin;