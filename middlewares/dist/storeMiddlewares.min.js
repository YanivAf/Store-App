"use strict";exports.__esModule=!0,exports.enoughInStock=exports.doesProductExist=exports.doesStoreExist=void 0;var secret=require("../../secret/dist/secret").secret,_a=require("../../models/dist/storesModel"),Product=_a.Product,Store=_a.Store,Stores=_a.Stores,_b=require("../../models/dist/usersModel"),CartProduct=_b.CartProduct,User=_b.User,Users=_b.Users;function doesStoreExist(e,s,t){var o,r;try{var d=new Stores,n=null!==(o=e.params.storeUuid)&&void 0!==o?o:e.body.storeUuid;if("mall"===n)return n=null!==(r=e.body.storeUuid)&&void 0!==r?r:n,void t();var u=d.findStoreIndex(n);return void(-1===u?s.status(404).send({message:"Store doesn't exist. Apologies for the inconvenience."}):(e.storeUuid=n,e.storeIndex=u,t()))}catch(e){console.error(e.message),s.status(500).send(e.message)}}function doesProductExist(e,s,t){var o;try{var r=new Stores,d=new Users,n=null!==(o=e.params.productUuid)&&void 0!==o?o:e.body.productUuid,u=e.storeIndex,i=e.userIndex,c=r.findStoreProductIndex(u,n),a=d.findCartProduct(i,n);return void(-1===c?s.status(404).send({message:"Product doesn't exist. Apologies for the inconvenience."}):(e.productIndex=c,e.cartProductIndex=a,t()))}catch(e){console.error(e.message),s.status(500).send(e.message)}}function enoughInStock(e,s,t){try{var o=new Stores,r=new Users,d=e.body.productQuantity,n=e.storeIndex,u=e.userIndex,i=e.productIndex,c=e.cartProductIndex,a=-1===c?0:r.users[u].cart[c].quantity;return void(o.stores[n].products[i].inStock+a<d?s.status(409).send({message:"Not enough items in stock. Apologies for the inconvenience."}):t())}catch(e){console.error(e.message),s.status(500).send(e.message)}}exports.doesStoreExist=doesStoreExist,exports.doesProductExist=doesProductExist,exports.enoughInStock=enoughInStock;